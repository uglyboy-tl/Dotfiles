---
name: git-commit
description: 创建原子 git 提交，遵循 Conventional Commits 格式。优先分析暂存文件并按功能模块拆分分组，创建多个聚焦提交。包含类型/范围/主题格式。
---

# Git 提交

创建原子 git 提交，遵循 Conventional Commits 格式。**执行时优先分析暂存文件，按功能模块拆分分组**。

## 最近项目提交

!`git log --oneline -5 2>/dev/null`

## 核心原则：原子提交分组

### 必须首先应用原子提交原则
1. **检查暂存状态**：`git status` 和 `git diff --staged`
2. **按功能分组**：应用以下决策逻辑：
   - 不同功能模块？→ 分开提交
   - 不同组件类型？→ 分开提交  
   - 可独立回滚？→ 分开提交
   - 功能紧密相关？→ 合并提交

### 分组标准
- 相同目录/模块在一起
- 相同组件类型（模型、服务、视图等）在一起
- 相同关注点（UI、逻辑、配置、测试）在一起
- 可独立回滚的分开

### 关键原则
- **默认多提交**：单一提交通常是错误信号
- **每个提交单一目的**：解决一个明确问题或实现一个清晰功能
- **优先功能拆分**：按功能模块拆分比按文件数量更重要

## 提交格式规范

### 基本格式
```
类型(范围): 主题
```

### 提交类型
- `feat`: 新功能
- `fix`: 错误修复  
- `docs`: 文档
- `style`: 格式调整
- `refactor`: 代码重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具
- `security`: 安全修复（项目特定）

### 范围要求
- **必需**：每个提交必须包含范围
- **格式**：kebab-case（如 `user-auth`、`api-gateway`）
- **要求**：简洁且反映更改的模块/组件

### 主题指南
- 命令式语气："添加"、"修复"、"更新"、"移除"
- 不超过 50 字符，不含句号
- 避免"更新代码"、"修复错误"等通用描述

### 正文格式（推荐）
```
类型(范围): 简短主题

详细描述：
- 更改原因
- 关键实现
- 可能影响
```

## 项目特定约定

- **范围必需**：所有提交必须包含范围
- **额外类型**：使用 `security` 表示安全相关修复
- **参考 AGENTS.md**：检查项目特定约定

## 示例

### 良好示例
```
feat(auth): 添加双因素认证支持
fix(api): 修复用户查询空指针异常
docs(readme): 更新安装说明
refactor(validation): 重构输入验证逻辑
```

### 不良示例
```
更新代码
修复错误
feat: 添加新功能（缺少范围）
fix(api): 修复了错误。（包含句号）
```

## 参考资料

- [Conventional Commits 规范](https://www.conventionalcommits.org/)
- [Git 提交消息最佳实践](https://cbea.ms/git-commit/)