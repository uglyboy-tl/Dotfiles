# Picom 配置文件 - 窗口合成器

#################################
#             圆角              #
#################################

corner-radius = 7.0; # 窗口圆角半径
rounded-corners-exclude = [ # 排除以下窗口不使用圆角
  "window_type = 'desktop'", # 桌面窗口
  "class_g = 'Polybar'"      # Polybar 状态栏
];

#################################
#             阴影              #
#################################

shadow = true; # 启用阴影
shadow-exclude = [ # 排除以下窗口不显示阴影
  "_GTK_FRAME_EXTENTS@", # GTK 框架扩展
  "class_g = 'Polybar'", # Polybar 状态栏
  "class_g = 'wechat'",  # 微信
  "class_g = 'wemeetapp'", # 腾讯会议
  "window_type = 'menu' && _NET_WM_STATE@ = '_NET_WM_STATE_ABOVE'" # 菜单窗口且置顶
];

shadow-radius = 6;   # 阴影模糊半径
shadow-opacity = 0.6; # 阴影不透明度
shadow-offset-x = -3; # 阴影 X 轴偏移
shadow-offset-y = -3; # 阴影 Y 轴偏移

#################################
#             淡入淡出          #
#################################

fading = true;       # 启用淡入淡出效果
fade-in-step = 0.03; # 淡入步长
fade-out-step = 0.03; # 淡出步长

#################################
#         透明度 / 不透明度     #
#################################
active-opacity = 1;     # 焦点窗口不透明度
inactive-opacity = 0.80; # 非焦点窗口不透明度
frame-opacity = 0.8;    # 窗口框架不透明度

popup_menu = { opacity = 0.85; }   # 弹出菜单不透明度
dropdown_menu = { opacity = 0.85; } # 下拉菜单不透明度
inactive-opacity-override = false; # 不覆盖非活动窗口的透明度设置

opacity-rule = [ # 针对特定窗口的透明度规则
  "100: name = 'Picture-in-Picture'", # 画中画窗口 100% 不透明
  "100: name = '画中画'",             # 画中画窗口 100% 不透明 (中文名称)
  "90:class_g = 'Rofi'",              # Rofi 启动器 90% 不透明
  "95:class_g = 'wechat'",            # 微信 95% 不透明
  "90:class_g = 'Polybar'",           # Polybar 状态栏 90% 不透明
  "90:class_g = 'Dunst'",             # Dunst 通知 90% 不透明
  "95:class_g = 'Alacritty' && focused",    # 焦点 Alacritty 终端 95% 不透明
  "75:class_g = 'Alacritty' && !focused",   # 非焦点 Alacritty 终端 75% 不透明
  "95:class_g = 'kitty' && focused",        # 焦点 Kitty 终端 95% 不透明
  "75:class_g = 'kitty' && !focused",       # 非焦点 Kitty 终端 75% 不透明
  "100:class_g = 'feh' && focused",         # 焦点 feh 图片查看器 100% 不透明
  "75:class_g = 'feh' && !focused"          # 非焦点 feh 图片查看器 75% 不透明
];

#################################
#         通用设置              #
#################################
inactive-dim = 0.0;          # 非活动窗口的亮度降低程度 (0.0 表示不降低)
mark-wmwin-focused = true;   # 标记焦点窗口
mark-overdir-focused = true; # 标记鼠标悬停的窗口
detect-rounded-corners = true; # 检测窗口是否为圆角
detect-client-opacity = true;  # 检测客户端是否设置了透明度

# 后端设置
backend = "glx";             # 使用 GLX 后端
glx-no-stencil = true;       # 禁用 GLX 模板缓冲区
glx-copy-from-front = false; # 不从前缓冲区复制